!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("TaskTimer",[],e):"object"==typeof exports?exports.TaskTimer=e():t.TaskTimer=e()}(this,function(){return function(t){function e(s){if(n[s])return n[s].exports;var r=n[s]={exports:{},id:s,loaded:!1};return t[s].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="/dist",e(0)}([function(t,e,n){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}var r=n(1),i=s(r);t.exports=i["default"]},function(t,e,n){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!t)return e||{};if(!e)return t||{};var n;for(n in e)e.hasOwnProperty(n)&&void 0===t[n]&&(t[n]=e[n]);return t}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,n,s){return n&&t(e.prototype,n),s&&t(e,s),e}}(),c=function p(t,e,n){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,e);if(void 0===s){var r=Object.getPrototypeOf(t);return null===r?void 0:p(r,e,n)}if("value"in s)return s.value;var i=s.get;if(void 0!==i)return i.call(n)},h=n(2),f=s(h),l={INTERVAL:1e3},v=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?l.INTERVAL:arguments[0];r(this,e);var n=i(this,Object.getPrototypeOf(e).call(this));return n._={},n._reset(),n._.interval=t,n}return o(e,t),u(e,[{key:"_stop",value:function(){this._.timer&&(clearInterval(this._.timer),this._.timer=null)}},{key:"_reset",value:function(){this._stop();var t=this._.interval;this._={interval:t,timer:null,state:e.State.IDLE,tasks:{},tickCount:0,startTime:0,stopTime:0}}},{key:"_tick",value:function(){var t=void 0,n=void 0,s=this._.tasks;this._.tickCount+=1,this.emit(e.Event.TICK);for(t in this._.tasks)s[t]&&(n=s[t],this._.tickCount%n.tickInterval===0&&(!n.totalRuns||n.currentRuns<n.totalRuns)&&(n.currentRuns+=1,"function"==typeof n.callback&&n.callback(n),this.emit(e.Event.TASK,n)))}},{key:"_run",value:function(){var t=this;this._.timer=setInterval(function(){t._tick(),t._.state=e.State.RUNNING},this._.interval)}},{key:"emit",value:function(t,n){var s={type:t,source:this};switch(t){case e.Event.TASK:case e.Event.TASK_ADDED:case e.Event.TASK_REMOVED:s.task=n}return c(Object.getPrototypeOf(e.prototype),"emit",this).call(this,t,s),this}},{key:"fire",value:function(t,e){return this.emit(t,e)}},{key:"getTask",value:function(t){return this._.tasks[t]}},{key:"addTask",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{tickInterval:1,totalRuns:0}:arguments[0];if("string"==typeof t&&(t={name:t,tickInterval:1,totalRuns:0}),!t.name)throw new Error("Task name is required.");if(this._.tasks[t.name])throw new Error('Task with name "'+t.name+'" already exists.');var n=a(t,{currentRuns:0});return this._.tasks[t.name]=n,this.emit(e.Event.TASK_ADDED,this.getTask(t.name)),this}},{key:"resetTask",value:function(t){if(!t||!this._.tasks[t])throw new Error('Task with name "'+t+'" does not exist.');this._.tasks[t].currentRuns=0}},{key:"removeTask",value:function(t){if(!t||!this._.tasks[t])throw new Error('Task with name "'+t+'" does not exist.');var n=this._.tasks[t];return this._.tasks[t]=null,delete this._.tasks[t],this.emit(e.Event.TASK_REMOVED,n),this}},{key:"start",value:function(){return this._stop(),this._.startTime=Date.now(),this._.stopTime=0,this._.tickCount=0,this._run(),this._.state=e.State.RUNNING,this.emit(e.Event.STARTED),this}},{key:"pause",value:function(){return this.state!==e.State.RUNNING?this:(this._stop(),this._.state=e.State.PAUSED,this.emit(e.Event.PAUSED),this)}},{key:"resume",value:function(){return this.state!==e.State.PAUSED?this:(this._run(),this._.state=e.State.RUNNING,this.emit(e.Event.RESUMED),this)}},{key:"stop",value:function(){return this.state!==e.State.RUNNING?this:(this._stop(),this._.stopTime=Date.now(),this._.state=e.State.STOPPED,this.emit(e.Event.STOPPED),this)}},{key:"reset",value:function(){return this._reset(),this.emit(e.Event.RESET),this}},{key:"listenerCount",value:function(t){return this.listeners(t).length}},{key:"interval",get:function(){return this._.interval},set:function(t){this._.interval=t||l.INTERVAL}},{key:"state",get:function(){return this._.state}},{key:"time",get:function(){var t=this.state!==e.State.STOPPED?Date.now():this._.stopTime;return Object.freeze({started:this._.startTime,stopped:this._.stopTime,elapsed:t-this._.startTime})}},{key:"tickCount",get:function(){return this._.tickCount}},{key:"taskCount",get:function(){return Object.keys(this._.tasks).length}}]),e}(f["default"]);v.Event=Object.freeze({TICK:"tick",STARTED:"started",RESUMED:"resumed",PAUSED:"paused",STOPPED:"stopped",RESET:"reset",TASK:"task",TASK_ADDED:"taskAdded",TASK_REMOVED:"taskRemoved"}),v.State=Object.freeze({IDLE:0,RUNNING:1,PAUSED:2,STOPPED:3}),e["default"]=v},function(t,e,n){"use strict";function s(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(){}var i=Object.prototype.hasOwnProperty,o="function"!=typeof Object.create&&"~";r.prototype._events=void 0,r.prototype.eventNames=function(){var t,e=this._events,n=[];if(!e)return n;for(t in e)i.call(e,t)&&n.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},r.prototype.listeners=function(t,e){var n=o?o+t:t,s=this._events&&this._events[n];if(e)return!!s;if(!s)return[];if(s.fn)return[s.fn];for(var r=0,i=s.length,a=new Array(i);r<i;r++)a[r]=s[r].fn;return a},r.prototype.emit=function(t,e,n,s,r,i){var a=o?o+t:t;if(!this._events||!this._events[a])return!1;var u,c,h=this._events[a],f=arguments.length;if("function"==typeof h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),f){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,s),!0;case 5:return h.fn.call(h.context,e,n,s,r),!0;case 6:return h.fn.call(h.context,e,n,s,r,i),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];h.fn.apply(h.context,u)}else{var l,v=h.length;for(c=0;c<v;c++)switch(h[c].once&&this.removeListener(t,h[c].fn,void 0,!0),f){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,e);break;case 3:h[c].fn.call(h[c].context,e,n);break;default:if(!u)for(l=1,u=new Array(f-1);l<f;l++)u[l-1]=arguments[l];h[c].fn.apply(h[c].context,u)}}return!0},r.prototype.on=function(t,e,n){var r=new s(e,n||this),i=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):this._events[i]=r,this},r.prototype.once=function(t,e,n){var r=new s(e,n||this,(!0)),i=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):this._events[i]=r,this},r.prototype.removeListener=function(t,e,n,s){var r=o?o+t:t;if(!this._events||!this._events[r])return this;var i=this._events[r],a=[];if(e)if(i.fn)(i.fn!==e||s&&!i.once||n&&i.context!==n)&&a.push(i);else for(var u=0,c=i.length;u<c;u++)(i[u].fn!==e||s&&!i[u].once||n&&i[u].context!==n)&&a.push(i[u]);return a.length?this._events[r]=1===a.length?a[0]:a:delete this._events[r],this},r.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[o?o+t:t]:this._events=o?{}:Object.create(null),this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=o,t.exports=r}])});
//# sourceMappingURL=tasktimer.min.js.map